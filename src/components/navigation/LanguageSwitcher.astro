---
import { languages, type LangCode } from '@/i18n/config';
import { getLocalizedPath } from '@/i18n/routes';

interface Props {
  currentLang: LangCode;
}

const { currentLang } = Astro.props;
// Ottiene la lista delle lingue escludendo quella corrente
const otherLangs = Object.entries(languages).filter(([code]) => code !== currentLang);
---

<div class="lang-dropdown">
  <button class="current-btn" aria-haspopup="true" aria-expanded="false" id="lang-menu-btn">
    {currentLang.toUpperCase()}
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
        <path d="m6 9 6 6 6-6"/>
    </svg>
  </button>
  
  <div class="dropdown-list" role="menu" aria-labelledby="lang-menu-btn">
    {otherLangs.map(([code, config]) => (
      <a href={getLocalizedPath(code as LangCode, 'home')} role="menuitem">
        {code.toUpperCase()} <small>({config.label})</small>
      </a>
    ))}
  </div>
</div>

<style>
  .lang-dropdown { position: relative; }
  
  .current-btn {
    color: #ffffff;
    font-size: 0.9rem;
    font-weight: 800;
    background: transparent;
    border: 1px solid rgba(223, 208, 144, 0.4);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.5rem 1rem;
    transition: 0.3s;
  }
  
  .current-btn:hover { border-color: #dfd090; color: #dfd090; }
  
  .dropdown-list {
    position: absolute;
    top: calc(100% + 10px);
    right: 0;
    min-width: 160px;
    background: #000033;
    border: 1px solid #dfd090;
    display: flex;
    flex-direction: column;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: 0.3s cubic-bezier(0.19, 1, 0.22, 1);
    box-shadow: 0 10px 30px rgba(0,0,0,0.8);
    z-index: 100;
  }

  .lang-dropdown:hover .dropdown-list {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .dropdown-list a {
    color: #ffffff;
    padding: 1rem;
    font-size: 0.85rem;
    font-weight: 700;
    text-decoration: none;
    border-bottom: 1px solid rgba(223, 208, 144, 0.1);
    transition: 0.2s;
  }

  .dropdown-list a:hover { background: #000080; color: #dfd090; }

  small { font-weight: 400; opacity: 0.6; margin-left: 0.5rem; font-size: 0.7rem; }
</style>